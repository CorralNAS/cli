_collection = "freenas"
_count = 20
_name = "test-vm"
_total = 0
_datastore="tank"

_templates = $(vm template show)
printf("Found %s templates\n", length(_templates))

for (_x in _templates) {
	for (i = 0; i < _count; i = i + 1) {
		_total = _total + 1
		vm create name=${_name + str(_total)} template=${_x["name"]} autostart=yes datastore=${_datastore}
	}
}

